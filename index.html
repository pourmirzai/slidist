<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="مولد اسلاید هوشمند فارسی - ایجاد اسلایدهای زیبا و حرفه‌ای">
    <meta name="keywords" content="اسلاید, پرزنتیشن, فارسی, مولد اسلاید">
    <meta name="author" content="Slidist">
    
    <title>اسلایدساز هوشمند - Slidist</title>
    
    <!-- External Dependencies -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/file-saver@2.0.5/dist/FileSaver.min.js"></script>
    
    <!-- Fonts -->
    <link href="https://cdn.jsdelivr.net/gh/rastikerdar/vazirmatn@v33.003/Vazirmatn-font-face.css" rel="stylesheet" type="text/css" />
    
    <!-- Styles -->
    <link rel="stylesheet" href="css/styles.css">
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>📊</text></svg>">
</head>
<body>
    <div class="container">
        <header>
            <h1>🎯 مولد اسلاید هوشمند</h1>
            <p>ایجاد اسلایدهای زیبا و حرفه‌ای با چند کلیک ساده</p>
        </header>

        <!-- Title Slide Settings -->
        <details open>
            <summary>۱. تنظیمات اسلاید عنوان</summary>
            <div class="details-content controls">
                <div class="control-item full-width">
                    <label for="titleText">عنوان اصلی:</label>
                    <input type="text" id="titleText" placeholder="عنوان اصلی را وارد کنید..." autocomplete="off">
                </div>
                
                <div class="control-item full-width">
                    <label for="subtitleText">زیرنویس (اختیاری):</label>
                    <input type="text" id="subtitleText" placeholder="متن زیرنویس را وارد کنید..." autocomplete="off">
                </div>
                
                <div class="control-item">
                    <label for="authorImageFile">عکس نویسنده (اختیاری):</label>
                    <input type="file" id="authorImageFile" accept="image/*" aria-describedby="authorImageHelp">
                    <div id="authorDropZone" class="drop-zone">
                        یا تصویر را اینجا بکشید و رها کنید
                    </div>
                    <small id="authorImageHelp">حداکثر ۱۰ مگابایت - فرمت‌های JPG, PNG, WebP</small>
                </div>
                
                <div class="control-item">
                    <label for="bgImageFile">تصویر پس‌زمینه:</label>
                    <input type="file" id="bgImageFile" accept="image/*" aria-describedby="bgImageHelp">
                    <div id="bgDropZone" class="drop-zone">
                        یا تصویر را اینجا بکشید و رها کنید
                    </div>
                    <small id="bgImageHelp">حداکثر ۱۰ مگابایت - فرمت‌های JPG, PNG, WebP</small>
                </div>
                
                <div class="control-item">
                    <label for="bgImageOpacity">شفافیت تصویر: <span id="opacityValue">0.3</span></label>
                    <input type="range" id="bgImageOpacity" min="0" max="1" step="0.05" value="0.3" aria-describedby="opacityHelp">
                    <small id="opacityHelp">تنظیم شفافیت تصویر پس‌زمینه</small>
                </div>
                
                <div class="control-item">
                    <label for="bgImageMode">حالت تصویر پس‌زمینه:</label>
                    <select id="bgImageMode" aria-describedby="bgModeHelp">
                        <option value="cover-center">وسط وسط (Cover)</option>
                        <option value="cover-top">وسط بالا (Cover)</option>
                        <option value="cover-bottom">وسط پایین (Cover)</option>
                        <option value="contain">تمام تصویر (Contain)</option>
                        <option value="stretch">کشیده (Stretch)</option>
                    </select>
                    <small id="bgModeHelp">نحوه نمایش تصویر پس‌زمینه</small>
                </div>
            </div>
        </details>

        <!-- General Settings -->
        <details open>
            <summary>۲. تنظیمات کلی و استایل</summary>
            <div class="details-content controls">
                <div class="control-item">
                    <label for="fontSize">اندازه فونت متن:</label>
                    <input type="number" id="fontSize" value="30" min="12" max="72" aria-describedby="fontSizeHelp">
                    <small id="fontSizeHelp">اندازه فونت بر حسب پیکسل</small>
                </div>
                
                <div class="control-item">
                    <label for="lineHeight">فاصله خطوط:</label>
                    <input type="number" id="lineHeight" value="2" step="0.1" min="1" max="3" aria-describedby="lineHeightHelp">
                    <small id="lineHeightHelp">ضریب فاصله بین خطوط</small>
                </div>
                
                <div class="control-item">
                    <label for="padding">حاشیه داخلی:</label>
                    <input type="number" id="padding" value="90" min="20" max="200" aria-describedby="paddingHelp">
                    <small id="paddingHelp">فاصله محتوا از لبه‌های اسلاید</small>
                </div>
                
                <div class="control-item">
                    <label for="footerText">متن فوتر (اختیاری):</label>
                    <input type="text" id="footerText" placeholder="مثلا: @YourPage" autocomplete="off">
                </div>
                
                <div class="control-item full-width">
                    <label>تم رنگی:</label>
                    <div id="theme-selector" role="radiogroup" aria-label="انتخاب تم رنگی"></div>
                </div>

                <div id="customColorControls" class="full-width controls" style="display: none;">
                    <div class="control-item">
                        <label for="bgColor1">رنگ پس‌زمینه ۱:</label>
                        <input type="color" id="bgColor1" value="#f5f5f5">
                    </div>
                    <div class="control-item">
                        <label for="bgColor2">رنگ پس‌زمینه ۲:</label>
                        <input type="color" id="bgColor2" value="#e0e0e0">
                    </div>
                    <div class="control-item">
                        <label for="textColor">رنگ متن:</label>
                        <input type="color" id="textColor" value="#212121">
                    </div>
                </div>
            </div>
        </details>

        <!-- Content Settings -->
        <details>
            <summary>۳. تنظیمات محتوا و بولت‌ها</summary>
            <div class="details-content controls">
                <div class="control-item checkbox-control">
                    <input type="checkbox" id="useBullets" checked aria-describedby="bulletsHelp">
                    <label for="useBullets">استفاده از بولت</label>
                    <small id="bulletsHelp">نمایش نقطه یا نماد در ابتدای هر خط</small>
                </div>
                
                <div class="control-item">
                    <label for="bulletSelect">انتخاب نوع بولت:</label>
                    <select id="bulletSelect">
                        <option value="✅">✅ تیک سبز</option>
                        <option value="🔹">🔹 لوزی آبی</option>
                        <option value="⚫️">⚫️ دایره سیاه</option>
                        <option value="➡️">➡️ فلش</option>
                        <option value="🔸">🔸 لوزی نارنجی</option>
                        <option value="📌">📌 پین</option>
                        <option value="⭐">⭐ ستاره</option>
                        <option value="custom">سفارشی...</option>
                    </select>
                    <input type="text" id="customBulletInput" placeholder="بولت سفارشی" style="display: none; margin-top: 8px;">
                </div>
            </div>
        </details>

        <!-- Advanced Settings -->
        <details>
            <summary>۴. تنظیمات پیشرفته</summary>
            <div class="details-content controls">
                <div class="control-item">
                    <label>آمار محتوا:</label>
                    <div id="contentStats" style="background: var(--bg-light); padding: 10px; border-radius: var(--border-radius); font-size: 14px;">
                        <div>تعداد کلمات: <span id="wordCount">0</span></div>
                        <div>زمان تقریبی مطالعه: <span id="readingTime">0</span> دقیقه</div>
                        <div>تعداد اسلایدهای تولیدی: <span id="slideCount">0</span></div>
                    </div>
                </div>
                
                <div class="control-item">
                    <label>مدیریت تنظیمات:</label>
                    <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                        <button type="button" onclick="slideGenerator.exportSettings()" class="btn-secondary" style="padding: 8px 16px; font-size: 14px;">
                            📤 صادر کردن تنظیمات
                        </button>
                        <input type="file" id="importSettings" accept=".json" style="display: none;">
                        <button type="button" onclick="document.getElementById('importSettings').click()" class="btn-secondary" style="padding: 8px 16px; font-size: 14px;">
                            📥 وارد کردن تنظیمات
                        </button>
                        <button type="button" onclick="slideGenerator.storageManager.clearSettings()" class="btn-danger" style="padding: 8px 16px; font-size: 14px;">
                            🗑️ پاک کردن تنظیمات
                        </button>
                    </div>
                </div>
            </div>
        </details>

        <!-- Main Content Input -->
        <div style="margin: 20px 0;">
            <label for="inputText" style="display: block; margin-bottom: 10px; font-weight: bold;">محتوای اسلایدها:</label>
            <textarea 
                id="inputText" 
                placeholder="متن خود را اینجا وارد کنید.&#x0a;## برای تیتر بزرگ&#x0a;### برای تیتر بزرگ در اسلاید جدید&#x0a;می‌توانید از ایموجی 😊 و Markdown **bold** یا *italic* استفاده کنید.&#x0a;&#x0a;> برای نقل قول از این علامت استفاده کنید&#x0a;&#x0a;- یا از خط تیره برای لیست&#x0a;- مورد دوم لیست"
                rows="8"
                aria-describedby="inputHelp"
            ></textarea>
            <small id="inputHelp">
                <strong>راهنما:</strong> 
                ### برای اسلاید جدید | 
                ## برای تیتر بزرگ | 
                **متن** برای بولد | 
                *متن* برای ایتالیک | 
                > برای نقل قول | 
                - برای لیست
            </small>
        </div>

        <!-- Action Buttons -->
        <div style="text-align: center; margin: 30px 0;">
            <button onclick="slideGenerator.previewSlides()" class="btn-primary" style="margin-left: 10px;">
                🎯 ایجاد پیش‌نمایش
            </button>
            <button onclick="slideGenerator.clearPreview()" class="btn-secondary">
                🗑️ پاک کردن پیش‌نمایش
            </button>
        </div>

        <!-- Preview Section -->
        <div id="preview" role="region" aria-label="پیش‌نمایش اسلایدها"></div>

        <!-- Help Section -->
        <details style="margin-top: 30px;">
            <summary>❓ راهنما و کلیدهای میانبر</summary>
            <div class="details-content">
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
                    <div>
                        <h4>کلیدهای میانبر:</h4>
                        <ul style="text-align: right; list-style: none; padding: 0;">
                            <li>⌨️ <kbd>Ctrl + Enter</kbd>: ایجاد پیش‌نمایش</li>
                            <li>⌨️ <kbd>Ctrl + S</kbd>: صادر کردن تنظیمات</li>
                            <li>⌨️ <kbd>Esc</kbd>: بستن پنجره بزرگنمایی</li>
                        </ul>
                    </div>
                    <div>
                        <h4>فرمت‌های پشتیبانی شده:</h4>
                        <ul style="text-align: right; list-style: none; padding: 0;">
                            <li>📝 **متن بولد**</li>
                            <li>📝 *متن ایتالیک*</li>
                            <li>📝 ### اسلاید جدید</li>
                            <li>📝 ## تیتر بزرگ</li>
                            <li>📝 > نقل قول</li>
                            <li>📝 - آیتم لیست</li>
                        </ul>
                    </div>
                </div>
            </div>
        </details>
    </div>

    <!-- Lightbox -->
    <div class="lightbox" id="lightbox" role="dialog" aria-modal="true" aria-label="بزرگنمایی اسلاید">
        <span class="close" id="closeLightbox" aria-label="بستن">&times;</span>
        <img src="" alt="بزرگنمایی اسلاید" id="lightboxImg">
    </div>

    <!-- Scripts -->
    <script type="module" src="js/slideGenerator.js"></script>
    
    <!-- Import settings handler -->
    <script>
        document.getElementById('importSettings').addEventListener('change', async (e) => {
            if (e.target.files && e.target.files[0]) {
                await window.slideGenerator.importSettings(e.target.files[0]);
                e.target.value = ''; // Reset file input
            }
        });

        // Update content stats on text change
        document.getElementById('inputText').addEventListener('input', () => {
            if (window.slideGenerator) {
                const stats = window.slideGenerator.getStats();
                document.getElementById('wordCount').textContent = stats.wordCount;
                document.getElementById('readingTime').textContent = stats.readingTime;
                document.getElementById('slideCount').textContent = stats.slideCount;
            }
        });
    </script>

    <!-- Service Worker for offline support -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then(registration => console.log('SW registered'))
                    .catch(error => console.log('SW registration failed'));
            });
        }
    </script>
</body>
</html>